{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Guardian Rule-Set",
  "type": "object",
  "properties": {
    "velocityBreach": {
      "type": "object",
      "properties": {
        "maxPayouts": { "type": "integer", "minimum": 1 },
        "windowSeconds": { "type": "integer", "minimum": 1 }
      },
      "required": ["maxPayouts", "windowSeconds"]
    },
    "bankSwap": {
      "type": "object",
      "properties": {
        "lookbackMinutes": { "type": "integer", "minimum": 1 },
        "minPayoutUsd": { "type": "integer", "minimum": 1 }
      },
      "required": ["lookbackMinutes", "minPayoutUsd"]
    },
    "geoMismatch": {
      "type": "object",
      "properties": {
        "mismatchChargeCount": { "type": "integer", "minimum": 1 }
      },
      "required": ["mismatchChargeCount"]
    }
  },
  "required": ["velocityBreach", "bankSwap", "geoMismatch"],
  "additionalProperties": false
} 